# Staging Environment Configuration
# CRM Microservices Platform

# Environment
ENVIRONMENT=staging
SPRING_PROFILES_ACTIVE=staging

# Service Discovery
EUREKA_INSTANCE_HOSTNAME=discovery-server
EUREKA_INSTANCE_PREFER_IP_ADDRESS=true
EUREKA_CLIENT_SERVICE_URL_DEFAULTZONE=http://discovery-server:8761/eureka

# Database Configuration
DB_HOST=postgres
DB_PORT=5432
DB_NAME=crm_platform
DB_USERNAME=crm_user
DB_PASSWORD=${DB_PASSWORD}
DB_POOL_SIZE=20
DB_CONNECTION_TIMEOUT=30000
DB_IDLE_TIMEOUT=600000
DB_MAX_LIFETIME=1800000

# Redis Configuration
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_DATABASE=0
REDIS_TIMEOUT=2000
REDIS_POOL_MAX_ACTIVE=16
REDIS_POOL_MAX_IDLE=8
REDIS_POOL_MIN_IDLE=2

# Kafka Configuration
KAFKA_BOOTSTRAP_SERVERS=kafka:29092
KAFKA_GROUP_ID=crm-staging
KAFKA_AUTO_OFFSET_RESET=earliest
KAFKA_ENABLE_AUTO_COMMIT=true
KAFKA_SESSION_TIMEOUT=30000
KAFKA_HEARTBEAT_INTERVAL=3000

# RabbitMQ Configuration
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_USERNAME=crm_user
RABBITMQ_PASSWORD=${RABBITMQ_PASSWORD}
RABBITMQ_VIRTUAL_HOST=/

# Elasticsearch Configuration
ELASTICSEARCH_HOST=elasticsearch
ELASTICSEARCH_PORT=9200
ELASTICSEARCH_SCHEME=http
ELASTICSEARCH_USERNAME=
ELASTICSEARCH_PASSWORD=

# Security Configuration
JWT_SECRET=${JWT_SECRET}
JWT_EXPIRATION=86400
JWT_REFRESH_EXPIRATION=604800
CORS_ALLOWED_ORIGINS=https://staging.crm.company.com,https://staging-api.crm.company.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Authorization,Content-Type,X-Tenant-ID,X-Request-ID

# API Gateway Configuration
GATEWAY_RATE_LIMIT_ENABLED=true
GATEWAY_RATE_LIMIT_REQUESTS_PER_MINUTE=1000
GATEWAY_CIRCUIT_BREAKER_ENABLED=true
GATEWAY_CIRCUIT_BREAKER_FAILURE_THRESHOLD=50
GATEWAY_CIRCUIT_BREAKER_TIMEOUT=10000
GATEWAY_RETRY_ATTEMPTS=3
GATEWAY_RETRY_DELAY=1000

# Logging Configuration
LOG_LEVEL_ROOT=INFO
LOG_LEVEL_CRM=INFO
LOG_LEVEL_SPRING=WARN
LOG_LEVEL_HIBERNATE=WARN
LOG_FILE_PATH=/app/logs
LOG_FILE_MAX_SIZE=50MB
LOG_FILE_MAX_HISTORY=30
LOG_PATTERN=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level [%X{traceId},%X{spanId}] %logger{36} - %msg%n

# Monitoring Configuration
METRICS_ENABLED=true
METRICS_EXPORT_PROMETHEUS=true
TRACING_ENABLED=true
ZIPKIN_BASE_URL=http://zipkin:9411
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s

# Staging Features
DEBUG_ENABLED=false
SWAGGER_ENABLED=true
H2_CONSOLE_ENABLED=false
ACTUATOR_ENDPOINTS_ENABLED=true
ACTUATOR_ENDPOINTS_EXPOSURE=health,info,metrics,prometheus

# File Storage Configuration
FILE_STORAGE_TYPE=s3
FILE_STORAGE_BUCKET=crm-staging-files
FILE_STORAGE_REGION=us-east-1
FILE_MAX_SIZE=50MB
FILE_ALLOWED_TYPES=jpg,jpeg,png,pdf,doc,docx,xls,xlsx,csv

# Email Configuration
EMAIL_ENABLED=true
EMAIL_HOST=${EMAIL_HOST}
EMAIL_PORT=587
EMAIL_USERNAME=${EMAIL_USERNAME}
EMAIL_PASSWORD=${EMAIL_PASSWORD}
EMAIL_FROM=noreply@staging.crm.company.com
EMAIL_TLS_ENABLED=true

# Cache Configuration
CACHE_TYPE=redis
CACHE_TTL=3600
CACHE_MAX_SIZE=10000
CACHE_CLUSTER_ENABLED=false

# Performance Configuration
JVM_OPTS=-Xms512m -Xmx1024m -XX:+UseG1GC -XX:MaxGCPauseMillis=200
CONNECTION_POOL_SIZE=20
THREAD_POOL_SIZE=50
ASYNC_POOL_SIZE=20

# Feature Flags
FEATURE_ANALYTICS_ENABLED=true
FEATURE_WORKFLOWS_ENABLED=true
FEATURE_CUSTOM_OBJECTS_ENABLED=true
FEATURE_ADVANCED_SEARCH_ENABLED=true
FEATURE_BULK_OPERATIONS_ENABLED=true
FEATURE_BETA_FEATURES_ENABLED=true

# Security Settings
SECURITY_REQUIRE_HTTPS=true
SECURITY_HSTS_ENABLED=true
SECURITY_CSRF_ENABLED=true
SECURITY_CONTENT_SECURITY_POLICY=default-src 'self'

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=crm-staging-backups

# Alerting Configuration
ALERTS_ENABLED=true
ALERTS_SLACK_WEBHOOK=${SLACK_WEBHOOK_URL}
ALERTS_EMAIL_RECIPIENTS=devops@company.com,staging-alerts@company.com