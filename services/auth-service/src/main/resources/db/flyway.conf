# Flyway Configuration for Auth Service
# =====================================

# Database connection settings
flyway.url=jdbc:postgresql://localhost:5432/crm_auth_db
flyway.user=${DB_USERNAME:crm_auth_user}
flyway.password=${DB_PASSWORD:}
flyway.driver=org.postgresql.Driver

# Migration settings
flyway.locations=classpath:db/migration
flyway.schemas=public
flyway.table=flyway_schema_history
flyway.baseline-on-migrate=true
flyway.baseline-version=0
flyway.baseline-description=Initial baseline

# Validation settings
flyway.validate-on-migrate=true
flyway.clean-disabled=true
flyway.mixed=false
flyway.group=false
flyway.installed-by=auth-service

# Placeholder settings
flyway.placeholder-replacement=true
flyway.placeholders.service_name=auth-service
flyway.placeholders.schema_version=1.0
flyway.placeholders.environment=${ENVIRONMENT:development}

# Callback settings
flyway.callbacks=com.crm.platform.auth.migration.AuthMigrationCallback

# Retry settings
flyway.connect-retries=3
flyway.connect-retries-interval=10

# Output settings
flyway.output-query-results=true

# Target version (leave empty for latest)
# flyway.target=

# Ignore settings for production safety
flyway.ignore-missing-migrations=false
flyway.ignore-ignored-migrations=false
flyway.ignore-pending-migrations=false
flyway.ignore-future-migrations=false

# Repair settings
flyway.repair-on-migrate=false

# Encoding
flyway.encoding=UTF-8

# SQL migration settings
flyway.sql-migration-prefix=V
flyway.sql-migration-separator=__
flyway.sql-migration-suffixes=.sql
flyway.repeatable-sql-migration-prefix=R

# Transaction settings
flyway.execute-in-transaction=true

# Lock retry settings
flyway.lock-retry-count=50

# Oracle specific settings (not applicable for PostgreSQL)
# flyway.oracle-sqlplus=false
# flyway.oracle-sqlplus-warn=false

# PostgreSQL specific settings
flyway.postgresql-transactional-lock=true

# Batch settings
flyway.batch=false

# Stream settings
flyway.stream=false

# Skip default callbacks
flyway.skip-default-callbacks=false

# Skip default resolvers
flyway.skip-default-resolvers=false

# Error overrides (use with caution)
# flyway.error-overrides=

# Dry run mode (for testing)
# flyway.dry-run-output=

# Cherry pick migrations
# flyway.cherry-pick=

# Configuration for different environments
[development]
flyway.url=jdbc:postgresql://localhost:5432/crm_auth_db_dev
flyway.clean-disabled=false

[test]
flyway.url=jdbc:postgresql://localhost:5432/crm_auth_db_test
flyway.clean-disabled=false

[staging]
flyway.url=jdbc:postgresql://staging-db:5432/crm_auth_db
flyway.clean-disabled=true
flyway.validate-on-migrate=true

[production]
flyway.url=jdbc:postgresql://prod-db:5432/crm_auth_db
flyway.clean-disabled=true
flyway.validate-on-migrate=true
flyway.out-of-order=false