package com.crm.platform.security.vulnerability;

import java.util.List;

/**
 * Result of a security scan
 */
public class SecurityScanResult {
    
    private final boolean safe;
    private final ThreatType threatType;
    private final List<String> threats;
    
    private SecurityScanResult(boolean safe, ThreatType threatType, List<String> threats) {
        this.safe = safe;
        this.threatType = threatType;
        this.threats = threats;
    }
    
    public static SecurityScanResult safe() {
        return new SecurityScanResult(true, ThreatType.NONE, List.of());
    }
    
    public static SecurityScanResult threat(ThreatType threatType, List<String> threats) {
        return new SecurityScanResult(false, threatType, threats);
    }
    
    public boolean isSafe() {
        return safe;
    }
    
    public ThreatType getThreatType() {
        return threatType;
    }
    
    public List<String> getThreats() {
        return threats;
    }
    
    @Override
    public String toString() {
        return "SecurityScanResult{" +
                "safe=" + safe +
                ", threatType=" + threatType +
                ", threats=" + threats +
                '}';
    }
}